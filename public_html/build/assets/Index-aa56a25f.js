import{r as x,j as e,a as S,b as R}from"./app-11c91ab6.js";import{A as F}from"./AuthenticatedLayout-3f74296c.js";import{E as T}from"./jspdf.es.min-2a9d7818.js";import I from"./reporte_Tasks-cd5c978b.js";import L from"./reporte_documentos-a9286e67.js";import{f as l}from"./index-af05e076.js";import"./transition-13535cd8.js";import"./Modal-e781db1e.js";import"./typeof-7fd5df1e.js";function G({auth:m,TaskTypes:N,clientes:v,estados:k,empresa:f}){const b=m.user.Tasks.filter(t=>t.tipo_id>2),g=[];b.forEach(t=>{t.files&&t.files.length>0&&g.push(...t.files)});const[p,D]=x.useState(g),[h,C]=x.useState(b),[i,y]=x.useState(0),[s,d]=x.useState({inicio:0,fin:0,tipo:0,cliente:0,estado:0,fecha:new Date().toLocaleDateString(),hora:new Date().toLocaleTimeString("en-US",{hour12:!0}),usuario:m.user.name});x.useEffect(()=>{console.log(s),_()},[s]);const _=()=>{const t=new Date(s.inicio+" 00:00:00"),r=new Date(s.fin+" 23:59:59"),n=b.filter(o=>{const c=new Date(o.created_at);return!(s.inicio&&c<t||s.fin&&c>r||s.tipo&&o.tipo_id!==s.tipo||s.cliente&&o.user.name!==s.cliente||s.estado&&o.status_id!==s.estado)}),a=g.filter(o=>{const c=new Date(o.created_at);return!(s.inicio&&c<t||s.fin&&c>r||s.cliente&&o.user.name!==s.cliente)});i==0?C(n):(D(a),console.log(a))},u=t=>{const r=new T("p","pt","a4");r.setFontSize(5);const n=document.createElement("div"),a=R(n),o={...s,inicio:s.inicio?l(new Date(s.inicio),"dd/MM/yyyy"):"Inicio",fin:s.fin?l(new Date(s.fin),"dd/MM/yyyy"):"Fin"};document.body.appendChild(n),t==0?a.render(e.jsx(I,{Tasks_f:h,datos:o,empresa:f})):t==1&&a.render(e.jsx(L,{documentos_f:p,datos:s,empresa:f}));const c=n.offsetWidth,w=590;console.log(c,w);const M=w/c;r.html(n,{x:5,y:5,html2canvas:{scale:M},callback:function(E){E.save("report.pdf"),a.unmount(),document.body.removeChild(n)}})},j=()=>{const t=[{ruta:"/reportes/generar/soli",name:"reporte_Tasks.xlsx",datos:{...s,inicio:s.inicio?l(new Date(s.inicio),"dd/MM/yyyy"):"Inicio",fin:s.fin?l(new Date(s.fin),"dd/MM/yyyy"):"Fin"},Tasks_f:h},{ruta:"/reportes/generar/docu",name:"reporte_documentos.xlsx",datos:{...s,inicio:s.inicio?l(new Date(s.inicio),"dd/MM/yyyy"):"Inicio",fin:s.fin?l(new Date(s.fin),"dd/MM/yyyy"):"Fin"},documentos_f:p}];axios.post(t[i].ruta,{data:t[i]},{responseType:"blob"}).then(r=>{console.log(r);const n=window.URL.createObjectURL(new Blob([r.data])),a=document.createElement("a");a.href=n,a.setAttribute("download",t[i].name),document.body.appendChild(a),a.click()}).catch(r=>{console.error("Error al descargar el archivo:",r)})};return e.jsx(F,{countNotificaciones:m.countNotificaciones,user:m.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Reportes"}),children:e.jsxs(e.Fragment,{children:[e.jsx(S,{title:"Reportes"}),e.jsxs("div",{className:"mx-10 mt-3",children:[e.jsxs("div",{className:"flex text-black ",children:[e.jsxs("button",{onClick:()=>y(0),className:` rounded-t-2xl cursor-pointer flex items-center gap-2 h-10 p-2 bg-gray-300  ${i==0?"bg-white ":""}  font-semibold text-base `,children:[e.jsx("img",{src:"/assets/svg/export2.svg",width:30,height:30,alt:"icon documento"}),"Tasks"]}),e.jsxs("button",{onClick:()=>y(1),className:`rounded-t-2xl cursor-pointer flex items-center gap-2 h-10 p-2 bg-gray-300 ${i==1?"bg-white ":""}  font-semibold text-base `,children:[e.jsx("img",{src:"/assets/svg/document2.svg",width:30,height:30,alt:"icon documento"}),"Documentos"]})]}),e.jsxs("div",{className:"rounded-tl-none mb-4 bg-white p-4 rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex gap-8 my-3",children:[e.jsxs("label",{className:" flex flex-col ",children:[e.jsx("span",{className:"font-semibold",children:"Fecha de inicio"}),e.jsx("input",{max:s.fin,className:"p-0 px-2 rounded-md w-52 h-8",type:"date",value:s.inicio,onChange:t=>d({...s,inicio:t.target.value})})]}),e.jsxs("label",{className:"flex flex-col ",children:[e.jsx("span",{className:"font-semibold",children:"Fecha de fin"}),e.jsx("input",{min:s.inicio,className:"p-0 px-2 rounded-md w-52 h-8",type:"date",value:s.fin,onChange:t=>d({...s,fin:t.target.value})})]}),e.jsxs("label",{className:"flex  flex-col",children:[e.jsx("span",{className:"font-semibold",children:"Cliente:"}),e.jsxs("select",{required:!0,value:s.cliente,onChange:t=>d({...s,cliente:t.target.value}),name:"cliente",id:"cliente",className:"p-0 px-2 pe-6 w-fit min-w-[13rem] rounded-md  h-8",children:[e.jsx("option",{value:"",select:!0,children:"Todos"}),v.map(t=>e.jsx("option",{value:t.name,children:t.name},t.id))]})]})]}),i==0&&e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("label",{className:"flex  flex-col ",children:[e.jsx("span",{className:"font-semibold",children:" Tipo Tasks:"}),e.jsxs("select",{required:!0,value:s.tipo,onChange:t=>d({...s,tipo:parseInt(t.target.value)}),name:"tipo_id",id:"tipo_id",className:"p-0 px-2 w-fit rounded-md h-8",children:[e.jsx("option",{value:0,select:!0,children:"Todas"}),N.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]}),e.jsxs("label",{className:"flex  flex-col",children:[e.jsx("span",{className:"font-semibold",children:"Estados:"}),e.jsxs("select",{required:!0,value:s.estado,onChange:t=>d({...s,estado:parseInt(t.target.value)}),name:"estado",id:"estado",className:"p-0 px-2 pe-6 w-fit min-w-[13rem] rounded-md  h-8",children:[e.jsx("option",{value:"",select:!0,children:"Todos"}),k.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))]})]})]})]}),i==0?e.jsx("div",{children:e.jsx("div",{id:"contenido",className:"",children:e.jsx("div",{className:"-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto",children:e.jsxs("div",{className:"inline-block min-w-full shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-white w-full px-3 py-2",children:e.jsxs("div",{className:" flex items-center gap-3 font-bold ",children:[e.jsx("span",{children:"Exportar"}),e.jsx("button",{className:"hover:scale-125",onClick:()=>u(i),children:e.jsx("img",{src:"/assets/svg/pdf.svg",width:30,height:30,alt:"icon documento"})}),e.jsx("button",{className:"hover:scale-125",onClick:()=>j(),children:e.jsx("img",{src:"/assets/svg/xlsx.svg",width:30,height:30,alt:"icon documento"})})]})}),e.jsxs("table",{className:"min-w-full leading-normal overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"# Task"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"RNC"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Fecha"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"CORREO"})]})}),e.jsx("tbody",{children:h&&h.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.numero})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.tipo.name})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.user.name})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.user.rnc})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:l(new Date(t.created_at),"dd/MM/yyyy hh:mm:ss a")})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.status.name})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.user.email})})]},r))})]})]})})})}):e.jsx("div",{children:e.jsx("div",{id:"contenido",className:"",children:e.jsx("div",{className:"-mx-4 sm:-mx-8 px-4 sm:px-8 py-4 overflow-x-auto",children:e.jsxs("div",{className:"inline-block min-w-full shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-white w-full px-3 py-2",children:e.jsxs("div",{className:" flex items-center gap-3 font-bold ",children:[e.jsx("span",{children:"Exportar"}),e.jsx("button",{className:"hover:scale-125",onClick:()=>u(i),children:e.jsx("img",{src:"/assets/svg/pdf.svg",width:30,height:30,alt:"icon documento"})}),e.jsx("button",{className:"hover:scale-125",onClick:()=>j(),children:e.jsx("img",{src:"/assets/svg/xlsx.svg",width:30,height:30,alt:"icon documento"})})]})}),e.jsxs("table",{className:"min-w-full leading-normal overflow-hidden",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"ID"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"name"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Tipo Documento"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Usuario"}),e.jsx("th",{className:"px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Fecha"})]})}),e.jsx("tbody",{children:p&&p.map((t,r)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-base font-medium",children:t.id}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.name})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.extencion})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.user.name})}),e.jsx("td",{className:"px-5 py-3 border-b border-gray-200 bg-white text-sm",children:e.jsx("p",{className:"text-gray-900 whitespace-no-wrap",children:t.created_at&&l(new Date(t.created_at),"dd/MM/yyyy hh:mm:ss a")})})]},r))})]})]})})})})]})]})})}export{G as default};
